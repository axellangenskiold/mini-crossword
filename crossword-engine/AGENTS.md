---

# ðŸ“„ `/engine/AGENTS.md` â€” Crossword Generator (FINAL)

```md
# AGENTS.md â€” Crossword Generator Engine (Python)

Offline Python program that generates mini crossword puzzles.
The engine runs on a developer machine and outputs static JSON files
that are bundled into the iOS app.

The engine is not shipped with the App Store binary.

---

## Goals

- Generate unique mini crosswords
- Grid sizes: **5Ã—5 to 7Ã—6**
- **0â€“4 black border cells** with strict corner-connectivity rules
- Fill valid across and down entries
- Embed **clues directly in puzzle JSON**
- Deduplicate puzzles via hashing

---

## Black Cell Rules

- Only border cells may be black
- Maximum of 4 black cells
- Any black cell must be connected to a corner on that side via a contiguous chain
- Rules must exactly match the iOS app

---

## Slot Extraction

- Identify across and down entries (length â‰¥ 2)
- Standard crossword numbering
- For each entry output:
  - number
  - direction (across/down)
  - ordered list of cell coordinates
  - answer (Aâ€“Z)
  - clue (string)

---

## Filling Strategy

Use constraint-based backtracking (not naive brute force).

### Required heuristics

- MRV (minimum remaining values)
- Forward checking
- Cached candidate filtering by letter pattern

### Performance

- Pre-index wordlists by length and letter position
- Abort and resample grid on timeout
- Optional seed for deterministic generation

---

## Word Sources

- Word fetching/building may occur during generation
- Final wordlists are stored locally and version-controlled
- Categories:
  - core dictionary
  - names
  - slang
  - abbreviations
- Support allowlist and banlist filtering

The engine itself never runs inside the app.

---

## Clue Generation

- Clues (descriptions) are included directly in puzzle JSON
- May be generated by:
  - a separate AI agent
  - or a post-processing pipeline
- Clues must:
  - Not include the answer verbatim
  - Match intended difficulty
  - Be concise and mini-style

---

## Hashing & Deduplication

Canonical representation includes:

- width and height
- sorted black cell coordinates
- solution grid (row-major, `#` for black)

Hashing:

- SHA-256 over canonical bytes
- Puzzle ID format: `mcw_v1_<first16hex>`

Reject duplicates within and across runs.

---

## Output

- Static JSON file compatible with the iOS app schema
- One puzzle per day or per index (date assignment optional)

---

## Agent Rules

### Do

- Validate every puzzle before output
- Test black-cell constraints and slot numbering
- Keep generation reproducible when seeded

### Donâ€™t

- Donâ€™t output puzzles without clues
- Donâ€™t change canonicalization without bumping version
